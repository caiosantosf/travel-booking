{"version":3,"sources":["components/reservation/ReturnPayment.js"],"names":["ReturnPayment","props","useState","message","setMessage","match","params","status","id","useEffect","put","history","useHistory","a","config","headers","localStorage","getItem","api","get","res","data","post","user_id","datetime","errorHandled","errorApi","general","error","msg","Object","entries","response","forEach","value","substr","length","Fragment","className","role","style","display","type","onClick","push"],"mappings":"uMAuFeA,UAhFf,SAAuBC,GAAQ,IAAD,EACEC,mBAAS,IADX,mBACrBC,EADqB,KACZC,EADY,OAGLH,EAAMI,MAAMC,OAA3BC,EAHoB,EAGpBA,OAAQC,EAHY,EAGZA,GAEhBC,qBAAU,WACO,YAAXF,GACFG,EAAIF,KAEL,CAACD,EAAQC,IAEZ,IAAIG,EAAUC,cAERF,EAAG,uCAAG,WAAOF,GAAP,uBAAAK,EAAA,6DACJC,EAAS,CAAEC,QAAS,CACxB,iBAAmBC,aAAaC,QAAQ,WAFhC,kBAMUC,IAAIC,IAAJ,wBAAyBX,GAAMM,GANzC,cAMFM,EANE,OAQAC,EAASD,EAATC,KARA,SAUFH,IAAII,KAAK,sBAAuB,GAAI,CAAEP,QAAS,CACnD,iBAAkBC,aAAaC,QAAQ,SACvC,OAAS,EACT,QAAWI,EAAKE,QAChB,SAAYF,EAAKG,YAdX,0DAiBFC,EAAeC,YAAS,EAAD,KACZC,QACfvB,EAAWqB,EAAaG,QAEpBC,EAAM,GACVC,OAAOC,QAAQ,KAAMC,SAASX,MAAMY,SAAQ,YAAmB,IAAD,mBAAXC,GAAW,WAC5DL,GAAG,UAAOK,EAAP,UAELL,EAAMA,EAAIM,OAAO,EAAGN,EAAIO,OAAS,GACjChC,EAAWyB,IA1BL,0DAAH,sDA+BT,OACE,eAAC,IAAMQ,SAAP,WACE,cAAC,IAAD,IACA,qBAAKC,UAAU,uBAAf,SACE,sBAAKA,UAAU,6CAAf,UACE,cAAC,IAAD,IAEA,qBAAKA,UAAU,6DAA6DC,KAAK,QAC7EC,MAAOrC,EAAU,CAAEsC,QAAS,SAAW,CAAEA,QAAU,QADvD,SAEGtC,IAGH,yCAEA,uBAEY,YAAXI,EAAuB,iEAA2C,GACvD,YAAXA,EAAuB,mHAA0F,GACtG,YAAXA,EAAuB,uHAAwF,GAEhH,uBAEA,wBAAQmC,KAAK,SACLJ,UAAU,6BACVK,QAAS,WACPhC,EAAQiC,KAAK,MAHvB","file":"static/js/16.1e2d999e.chunk.js","sourcesContent":["import React, { useState, useEffect } from 'react'\r\nimport { useHistory } from \"react-router-dom\"\r\nimport NavHeader from '../nav/NavHeader'\r\nimport Sidebar from '../nav/Sidebar'\r\nimport { api } from '../../config/api'\r\nimport { errorApi } from '../../config/handleErrors'\r\n\r\nfunction ReturnPayment(props) {\r\n  const [message, setMessage] = useState('')\r\n\r\n  const { status, id } = props.match.params\r\n\r\n  useEffect(() => {\r\n    if (status !== 'failure') {\r\n      put(id)\r\n    }\r\n  }, [status, id])\r\n\r\n  let history = useHistory()\r\n\r\n  const put = async (id) => {\r\n    const config = { headers :{\r\n      'x-access-token' : localStorage.getItem('token')\r\n    }}\r\n\r\n    try {\r\n      const res = await api.get(`/reservations/${id}`, config)\r\n\r\n      const { data } = res\r\n\r\n      await api.post('/reservations-email', {}, { headers :{\r\n        'x-access-token': localStorage.getItem('token'),\r\n        'email': true,\r\n        'user_id': data.user_id,\r\n        'datetime': data.datetime\r\n      }})\r\n    } catch (error) {\r\n      const errorHandled = errorApi(error)\r\n      if (errorHandled.general) {\r\n        setMessage(errorHandled.error)\r\n      } else {\r\n        let msg = ''\r\n        Object.entries(error.response.data).forEach(([key, value]) => {\r\n          msg += `${value} | `\r\n        })\r\n        msg = msg.substr(0, msg.length - 3)\r\n        setMessage(msg)\r\n      }\r\n    }\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <NavHeader />\r\n      <div className=\"container-fluid mb-4\">\r\n        <div className=\"mt-4 col-md-9 ms-sm-auto col-lg-10 px-md-2\">\r\n          <Sidebar />\r\n\r\n          <div className='alert text-center alert-dismissible alert-danger fade show' role=\"alert\"\r\n              style={message ? { display: 'block'} : { display : 'none' }}>\r\n            {message}\r\n          </div>\r\n\r\n          <h5>Reserva</h5>\r\n\r\n          <br />\r\n\r\n          {status === 'success' ? <h6>Pagamento efetuado com sucesso!</h6> : ''}\r\n          {status === 'failure' ? <h6>O pagamento pagamento falhou, se desejar faça outra reserva e tente novamente!</h6> : ''}\r\n          {status === 'pending' ? <h6>O pagamento está pendente, você deverá receber um email quando for aprovado!</h6> : ''}\r\n\r\n          <br />\r\n\r\n          <button type=\"button\" \r\n                  className=\"btn btn-warning text-white\"\r\n                  onClick={() => {\r\n                    history.push('/')\r\n                  }}>\r\n            Voltar\r\n          </button>\r\n\r\n        </div>\r\n      </div>\r\n    </React.Fragment>\r\n  )\r\n}\r\n\r\nexport default ReturnPayment\r\n"],"sourceRoot":""}